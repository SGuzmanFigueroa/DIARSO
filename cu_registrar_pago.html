<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registrar Pago</title>
    <link rel="stylesheet" href="cu_registrar_pago.css">
</head>
<body>
    <header>
  <h1>Plaza Vea – Gestión de Pedidos</h1>
  <small>Actor: Caja – Registrar pago del sistema</small>
</header>

<main>
  <button class="btn-volver" onclick="location.href='actor_caja.html'">
    ← Volver a actor Caja
  </button>

  <!-- PANEL ESTADO CAJA / LOGIN -->
  <section class="card">
    <h2>Estado de Caja</h2>
    <p class="descripcion">
      Antes de registrar pagos, el cajero debe iniciar sesión y abrir la caja.
    </p>

    <div class="estado-caja">
      <span>Estado actual: </span>
      <span id="lbl-estado-caja" class="badge badge-cerrada">CAJA CERRADA</span>
    </div>

    <form id="form-login" class="form-inline">
      <div>
        <label>Código de cajero</label>
        <input type="text" id="login-user" placeholder="Ej: CAJA01" required>
      </div>
      <div>
        <label>Contraseña</label>
        <input type="password" id="login-pass" placeholder="****" required>
      </div>
      <button type="submit" class="btn">Iniciar turno</button>
    </form>

    <p class="nota">
      Demo: usuario <b>CAJA01</b> – contraseña <b>1234</b>.
    </p>

    <button id="btn-cerrar-caja" class="btn btn-secondary" disabled>
      Cerrar caja
    </button>
  </section>

  <!-- PANEL REGISTRO DE PAGO -->
  <section class="card" id="panel-pago" aria-disabled="true">
    <h2>Registrar Pago</h2>
    <p class="descripcion">
      El cajero registra datos del cliente, escanea productos, selecciona el método
      de pago y genera la boleta.
    </p>

    <div class="layout-pago">
      <!-- LADO IZQUIERDO: FORMULARIOS -->
      <div class="panel-izq">
        <!-- Datos del cliente -->
        <div class="subcard">
          <h3>1. Datos del cliente</h3>
          <label>DNI del cliente</label>
          <input type="text" id="dni-cliente" maxlength="8" placeholder="Ej: 74563218">

          <label>Código de trabajador (cajero)</label>
          <input type="text" id="cod-trabajador" placeholder="Ej: CAJA01">
        </div>

        <!-- Escaneo de productos -->
        <div class="subcard">
          <h3>2. Escanear / agregar productos</h3>
          <div class="form-inline">
            <div>
              <label>Cód. producto</label>
              <input type="text" id="cod-producto" placeholder="Ej: P001">
            </div>
            <div>
              <label>Cantidad</label>
              <input type="number" id="cant-producto" min="1" value="1">
            </div>
            <button type="button" class="btn" id="btn-agregar">Agregar</button>
          </div>
          <p class="nota">
            Demo de productos: P001, P002, P003, P004 (definidos en JS).
          </p>
        </div>

        <!-- Método de pago -->
        <div class="subcard">
          <h3>3. Método de pago</h3>

          <label>Método</label>
          <select id="metodo-pago">
            <option value="">Seleccione…</option>
            <option value="efectivo">Efectivo</option>
            <option value="tarjeta">Tarjeta</option>
            <option value="yape">Yape / Plin</option>
          </select>

          <div id="grupo-efectivo" class="grupo-efectivo hidden">
            <label>Monto recibido (S/)</label>
            <input type="number" id="monto-recibido" min="0" step="0.1">
          </div>
        </div>
      </div>

      <!-- LADO DERECHO: DETALLE Y TOTAL -->
      <div class="panel-der">
        <div class="subcard">
          <h3>Detalle de productos</h3>
          <table>
            <thead>
            <tr>
              <th>Código</th>
              <th>Producto</th>
              <th>Cant.</th>
              <th>P. Unit</th>
              <th>Subtotal</th>
              <th></th>
            </tr>
            </thead>
            <tbody id="tbody-detalle">
            <!-- filas dinámicas -->
            </tbody>
          </table>
        </div>

        <div class="subcard resumen">
          <div class="fila-resumen">
            <span>Total a pagar:</span>
            <span id="lbl-total">S/ 0.00</span>
          </div>
          <div class="fila-resumen" id="fila-cambio" style="display:none;">
            <span>Cambio:</span>
            <span id="lbl-cambio">S/ 0.00</span>
          </div>
          <button class="btn btn-confirmar" id="btn-confirmar">
            Confirmar pago y generar boleta
          </button>
          <p id="msg-error" class="msg-error hidden"></p>
        </div>
      </div>
    </div>
  </section>

  <!-- BOLETA GENERADA -->
  <section class="card" id="panel-boleta" style="display:none;">
    <h2>Boleta / Comprobante de pago</h2>
    <p class="descripcion">
      Resumen del pago registrado. Simula la boleta impresa al cliente.
    </p>

    <div id="boleta-contenido" class="boleta">
      <!-- se llena por JS -->
    </div>

    <button class="btn btn-secondary" onclick="imprimirBoleta()">
      Imprimir / Guardar boleta (simulado)
    </button>
  </section>
</main>

<script src="cu_registrar_pago.js"></script>
</body>
</html>